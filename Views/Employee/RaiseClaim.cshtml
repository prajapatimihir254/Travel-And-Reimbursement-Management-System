@model BizTravel.Models.TravelRequest
@{
    ViewData["Title"] = "Raise Claim";
}

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
    body {
        font-family: 'Poppins', sans-serif;
        background-color: #f4f7f6;
    }

    .claim-card {
        border: none;
        border-radius: 15px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        background: white;
        overflow: hidden;
        margin-bottom: 50px;
    }

    .card-header-custom {
        background: linear-gradient(135deg, #0d6efd, #0099ff);
        color: white;
        padding: 25px;
    }

    .form-label {
        font-weight: 600;
        color: #495057;
        margin-bottom: 8px;
        font-size: 0.9rem;
    }

    /* Input Styling */
    .input-group-text {
        background-color: #f8f9fa;
        border-right: none;
        border-radius: 10px 0 0 10px;
        color: #0d6efd;
    }

    .form-control, .form-select {
        border-left: none;
        border-radius: 0 10px 10px 0;
        padding: 12px;
        border-color: #ced4da;
    }

        .form-control:focus, .form-select:focus {
            box-shadow: none;
            border-color: #86b7fe;
        }

    /* Fix for border focus */
    .input-group:focus-within .input-group-text {
        border-color: #86b7fe;
    }

    /* File Upload Styling */
    .file-upload-wrapper {
        background-color: #f8f9fa;
        border: 2px dashed #dee2e6;
        border-radius: 10px;
        padding: 20px;
        text-align: center;
        transition: 0.3s;
    }

        .file-upload-wrapper:hover {
            border-color: #0d6efd;
            background-color: #e7f1ff;
        }

    .btn-submit {
        background: linear-gradient(135deg, #0d6efd, #0056b3);
        border: none;
        border-radius: 50px;
        padding: 12px 40px;
        font-weight: 600;
        letter-spacing: 1px;
        box-shadow: 0 4px 15px rgba(13, 110, 253, 0.3);
        transition: 0.3s;
    }

        .btn-submit:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(13, 110, 253, 0.4);
        }
</style>

<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">

            <div class="claim-card animate__animated animate__fadeInUp">

                <div class="card-header-custom text-center">
                    <h3 class="mb-1"><i class="bi bi-airplane-engines me-2"></i>Raise New Request</h3>
                    <p class="mb-0 opacity-75 small">Fill in the details for your upcoming travel</p>
                </div>

                <div class="card-body p-4">
                    <form asp-action="RaiseClaim" method="post" enctype="multipart/form-data">

                        <h6 class="text-muted text-uppercase small fw-bold mb-3 border-bottom pb-2">Trip Details</h6>
                        <div class="row">
                            <div class="col-md-6 mb-4">
                                <label class="form-label">Departure Date</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="bi bi-calendar-event"></i></span>
                                    <input asp-for="TravelDate" type="date" class="form-control" />
                                </div>
                                <span asp-validation-for="TravelDate" class="text-danger small"></span>
                            </div>

                                <div class="col-md-6 mb-4">
                                    <label class="form-label">Return Date</label>
                                    <div class="input-group">
                                    <span class="input-group-text"><i class="bi bi-calendar-check"></i></span>
                                    <input asp-for="ReturnDate" type="date" class="form-control" />
                                    </div>
                                <span asp-validation-for="ReturnDate" class="text-danger small"></span>
                                </div>

                            <div class="col-md-6 mb-4">
                                <label class="form-label">Estimated Cost</label>
                                <div class="input-group">
                                    <span class="input-group-text fw-bold">₹</span>
                                    <input asp-for="EstimatedAmount" type="number" class="form-control" id="amtInput" placeholder="0.00" />
                                </div>
                                <span asp-validation-for="EstimatedAmount" class="text-danger small"></span>
                            </div>
                        </div>

                        <h6 class="text-muted text-uppercase small fw-bold mb-3 border-bottom pb-2 mt-2">Destination</h6>
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label class="form-label">Country</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="bi bi-globe"></i></span>
                                    <select id="country" asp-for="Country" class="form-select bg-light" readonly>
                                        <option value="India">India</option>
                                    </select>
                                </div>
                            </div>

                            <div class="col-md-4 mb-3">
                                <label class="form-label">State</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="bi bi-map"></i></span>
                                    <select id="stateSelect" asp-for="State" class="form-select" onchange="loadCities()">
                                        <option value="">-- Select State --</option>
                                        <option value="Andhra Pradesh">Andhra Pradesh</option>
                                        <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                        <option value="Assam">Assam</option>
                                        <option value="Bihar">Bihar</option>
                                        <option value="Chhattisgarh">Chhattisgarh</option>
                                        <option value="Goa">Goa</option>
                                        <option value="Gujarat">Gujarat</option>
                                        <option value="Haryana">Haryana</option>
                                        <option value="Himachal Pradesh">Himachal Pradesh</option>
                                        <option value="Jharkhand">Jharkhand</option>
                                        <option value="Karnataka">Karnataka</option>
                                        <option value="Kerala">Kerala</option>
                                        <option value="Madhya Pradesh">Madhya Pradesh</option>
                                        <option value="Maharashtra">Maharashtra</option>
                                        <option value="Manipur">Manipur</option>
                                        <option value="Meghalaya">Meghalaya</option>
                                        <option value="Mizoram">Mizoram</option>
                                        <option value="Nagaland">Nagaland</option>
                                        <option value="Odisha">Odisha</option>
                                        <option value="Punjab">Punjab</option>
                                        <option value="Rajasthan">Rajasthan</option>
                                        <option value="Sikkim">Sikkim</option>
                                        <option value="Tamil Nadu">Tamil Nadu</option>
                                        <option value="Telangana">Telangana</option>
                                        <option value="Tripura">Tripura</option>
                                        <option value="Uttar Pradesh">Uttar Pradesh</option>
                                        <option value="Uttarakhand">Uttarakhand</option>
                                        <option value="West Bengal">West Bengal</option>
                                        <option value="Delhi">Delhi</option>
                                    </select>
                                </div>
                                <span asp-validation-for="State" class="text-danger small"></span>
                            </div>

                            <div class="col-md-4 mb-3">
                                <label class="form-label">City</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="bi bi-geo-alt"></i></span>
                                    <select id="citySelect" asp-for="City" class="form-select">
                                        <option value="">-- Select City --</option>
                                    </select>
                                </div>
                                <span asp-validation-for="City" class="text-danger small"></span>
                            </div>
                        </div>

                        <h6 class="text-muted text-uppercase small fw-bold mb-3 border-bottom pb-2 mt-2">More Details</h6>

                        <div class="mb-4">
                            <label class="form-label">Purpose of Visit</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="bi bi-chat-text"></i></span>
                                <textarea asp-for="Purpose" class="form-control" rows="2" placeholder="e.g. Client Meeting with ABC Corp"></textarea>
                            </div>
                            <span asp-validation-for="Purpose" class="text-danger small"></span>
                        </div>

                        <div class="mb-4">
                            <label class="form-label">Upload Proof (Bill/Ticket)</label>
                            <div class="file-upload-wrapper">
                                <i class="bi bi-cloud-arrow-up display-6 text-primary mb-2"></i>
                                <input type="file" name="billFile" class="form-control" accept=".jpg,.jpeg,.pdf" required />
                                <small class="text-muted d-block mt-2">Supported formats: JPEG, PDF (Max 5MB)</small>
                            </div>
                        </div>

                        <div class="text-center mt-4">
                            <button type="submit" class="btn btn-primary btn-submit text-white w-100">
                                <i class="bi bi-send-fill me-2"></i> Submit Travel Request
                            </button>
                            <a asp-action="Dashboard" class="text-muted small d-block mt-3 text-decoration-none">Cancel & Return</a>
                        </div>

                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script type="text/javascript">
        function loadCities() {
            var stateElement = document.getElementById("stateSelect");
            var selectedState = stateElement.value;
            var citySelect = document.getElementById("citySelect");

            // Reset city dropdown
            citySelect.innerHTML = "<option value=''>-- Select City --</option>";

            var citiesData = {
                "Andhra Pradesh": ["Visakhapatnam", "Vijayawada", "Guntur", "Nellore", "Tirupati"],
                "Arunachal Pradesh": ["Itanagar", "Tawang", "Ziro", "Pasighat"],
                "Assam": ["Guwahati", "Dibrugarh", "Silchar", "Jorhat"],
                "Bihar": ["Patna", "Gaya", "Bhagalpur", "Muzaffarpur"],
                "Chhattisgarh": ["Raipur", "Bhilai", "Bilaspur", "Korba"],
                "Goa": ["Panaji", "Margao", "Vasco da Gama", "Mapusa"],
                "Gujarat": ["Ahmedabad", "Surat", "Vadodara", "Rajkot", "Gandhinagar"],
                "Haryana": ["Gurugram", "Faridabad", "Panipat", "Ambala"],
                "Himachal Pradesh": ["Shimla", "Manali", "Dharamshala", "Solan"],
                "Jharkhand": ["Ranchi", "Jamshedpur", "Dhanbad", "Bokaro"],
                "Karnataka": ["Bengaluru", "Mysuru", "Hubballi", "Mangaluru"],
                "Kerala": ["Thiruvananthapuram", "Kochi", "Kozhikode", "Thrissur"],
                "Madhya Pradesh": ["Indore", "Bhopal", "Jabalpur", "Gwalior", "Ujjain"],
                "Maharashtra": ["Mumbai", "Pune", "Nagpur", "Thane", "Nashik"],
                "Manipur": ["Imphal", "Churachandpur", "Thoubal"],
                "Meghalaya": ["Shillong", "Tura", "Jowai"],
                "Mizoram": ["Aizawl", "Lunglei", "Saiha"],
                "Nagaland": ["Kohima", "Dimapur", "Mokokchung"],
                "Odisha": ["Bhubaneswar", "Cuttack", "Rourkela", "Puri"],
                "Punjab": ["Ludhiana", "Amritsar", "Jalandhar", "Patiala"],
                "Rajasthan": ["Jaipur", "Jodhpur", "Udaipur", "Ajmer", "Bikaner"],
                "Sikkim": ["Gangtok", "Namchi", "Geyzing"],
                "Tamil Nadu": ["Chennai", "Coimbatore", "Madurai", "Salem"],
                "Telangana": ["Hyderabad", "Warangal", "Nizamabad", "Khammam"],
                "Tripura": ["Agartala", "Udaipur", "Dharmanagar"],
                "Uttar Pradesh": ["Lucknow", "Kanpur", "Varanasi", "Agra", "Noida"],
                "Uttarakhand": ["Dehradun", "Haridwar", "Roorkee", "Haldwani"],
                "West Bengal": ["Kolkata", "Howrah", "Durgapur", "Siliguri"],
                "Delhi": ["New Delhi", "North Delhi", "South Delhi", "East Delhi"]
            };

            if (selectedState && citiesData[selectedState]) {
                citiesData[selectedState].forEach(function(city) {
                    var opt = document.createElement("option");
                    opt.value = city;
                    opt.innerHTML = city;
                    citySelect.appendChild(opt);
                });
            }
        }
    </script>
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
}